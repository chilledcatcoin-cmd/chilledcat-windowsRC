<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chillpad</title>
<style>
  html, body {
    height: 100%;
    margin: 0;
    padding: 0;
  }

  body {
    background: #c0c0c0; /* Win95 grey */
    font-family: "MS Sans Serif", sans-serif;
    font-size: 14px;
    display: flex;
    flex-direction: column;
    position: relative;
  }

  /* Menu bar */
  #menubar {
    background: #dcdcdc;
    border-bottom: 2px solid #808080;
    padding: 2px 4px;
    display: flex;
    gap: 12px;
    font-size: 13px;
    flex-shrink: 0;
  }
  #menubar span { cursor: pointer; }
  #menubar span:hover { text-decoration: underline; }

  /* Text area */
  #editor {
    flex: 1;
    width: 100%;
    background: #fff;
    margin: 0;
    padding: 6px;
    border: none;
    outline: none;
    resize: none;
    box-sizing: border-box;
    font-family: "Courier New", monospace;
    font-size: 14px;
    color: #000;
  }

  /* Cat Assistant */
  #assistant {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 160px;
    text-align: center;
    font-size: 12px;
    color: #000;
    cursor: grab;
    user-select: none;
    animation: fadeIn 0.5s ease-in-out;
    z-index: 9999;
  }
  #assistant:active { cursor: grabbing; }

  #assistant img {
    width: 64px;
    height: 64px;
    image-rendering: pixelated;
    display: block;
    margin: 0 auto;
    user-drag: none;
    -webkit-user-drag: none;
    -moz-user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
    user-select: none;
    pointer-events: none; /* so clicks go to container */
  }

  #assistant-bubble {
    background: #ffffcc;
    border: 1px solid #808080;
    padding: 4px;
    margin-bottom: 4px;
    font-family: "MS Sans Serif", sans-serif;
    font-size: 12px;
    box-shadow: 2px 2px #404040;
  }

  /* Options menu */
  #assistant-options {
    background: #f0f0f0;
    border: 1px solid #808080;
    display: none;
    margin-bottom: 4px;
    box-shadow: 2px 2px #404040;
  }
  #assistant-options button {
    display: block;
    width: 100%;
    border: none;
    background: #f0f0f0;
    padding: 3px;
    font-size: 12px;
    text-align: left;
    cursor: pointer;
  }
  #assistant-options button:hover {
    background: #c0c0c0;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>
</head>
<body>
  <!-- Menu bar -->
  <div id="menubar">
    <span onclick="newFile()">File</span>
    <span onclick="editMenu()">Edit</span>
    <span onclick="viewMenu()">View</span>
    <span onclick="helpMenu()">Help</span>
  </div>

  <!-- Editor -->
  <textarea id="editor" spellcheck="false"></textarea>

  <!-- Chilled Cat Assistant -->
  <div id="assistant">
    <div id="assistant-bubble">Welcome to Chillpad üò∏</div>
    <div id="assistant-options">
      <button onclick="giveTip()">üí° Give me a tip</button>
      <button onclick="tellJoke()">üòÇ Tell me a joke</button>
      <button onclick="motivateMe()">üî• Motivate me</button>
    </div>
    <img id="assistant-img" src="../media/icons/app_chillpad.gif" alt="Chilled Cat Assistant">
  </div>

<script>
  const editor=document.getElementById("editor");
  const assistant=document.getElementById("assistant");
  const bubble=document.getElementById("assistant-bubble");
  const assistantImg=document.getElementById("assistant-img");
  const options=document.getElementById("assistant-options");

  // Menu actions
  function newFile(){
    if(confirm("Clear the text?")) editor.value="";
    showAssistant("Fresh start, nice and chill üò∏");
  }
  function editMenu(){ showAssistant("Try Ctrl+C and Ctrl+V, they‚Äôre classics!"); }
  function viewMenu(){ showAssistant("Looking good. Keep it chill."); }
  function helpMenu(){ showAssistant("Meow! I'm here to chill while you write."); }

  // Show cat assistant with a message
  function showAssistant(msg){
    bubble.textContent=msg;
    // restart GIF animation by resetting src
    const src = assistantImg.src;
    assistantImg.src = "";
    assistantImg.offsetHeight; // force reflow
    assistantImg.src = src;
  }

  // Easter egg: trigger the cat when user types "cat"
  editor.addEventListener("input",()=>{
    if(editor.value.toLowerCase().includes("cat")){
      showAssistant("You summoned meow! üêæ");
    }
  });

  // Make assistant draggable but prevent off-screen
  let drag=false, offsetX=0, offsetY=0;
  assistant.addEventListener("mousedown",(e)=>{
    // Only start dragging if not clicking options area
    if (e.target.id === "assistant-img" || e.target.id === "assistant") {
      drag=true;
      offsetX=e.clientX - assistant.offsetLeft;
      offsetY=e.clientY - assistant.offsetTop;
      document.addEventListener("mousemove",moveAssistant);
      document.addEventListener("mouseup",stopDrag);
    }
  });

  function moveAssistant(e){
    if(drag){
      let newX = e.clientX - offsetX;
      let newY = e.clientY - offsetY;
      const rect = assistant.getBoundingClientRect();
      const maxX = window.innerWidth - rect.width;
      const maxY = window.innerHeight - rect.height;
      if (newX < 0) newX = 0;
      if (newY < 0) newY = 0;
      if (newX > maxX) newX = maxX;
      if (newY > maxY) newY = maxY;
      assistant.style.left=newX+"px";
      assistant.style.top=newY+"px";
      assistant.style.bottom=""; // free-floating once moved
      assistant.style.right="";
    }
  }
  function stopDrag(){
    drag=false;
    document.removeEventListener("mousemove",moveAssistant);
    document.removeEventListener("mouseup",stopDrag);
  }

  // Toggle options when clicking the assistant container
  assistant.addEventListener("click",(e)=>{
    // Only toggle menu if clicked on cat itself (not buttons)
    if (e.target.id === "assistant-img" || e.target.id === "assistant-bubble") {
      options.style.display = options.style.display === "block" ? "none" : "block";
    }
  });

  // Functions for options
  const tips = [
    "Stay hydrated ü•§",
    "Stretch your paws üêæ",
    "Remember to save your work üíæ",
    "Keep it chill üòé"
  ];
  const jokes = [
    "Why did the cat sit on the computer? To keep an eye on the mouse.",
    "I'm paw-sitive you'll finish your work soon üò∏",
    "Don't worry, be furry!"
  ];
  const motivators = [
    "You got this! üê±üî•",
    "Stay cool and keep typing ‚ú®",
    "Every great story starts with one chill line üòé"
  ];

  function giveTip(){
    const msg=tips[Math.floor(Math.random()*tips.length)];
    showAssistant(msg);
    options.style.display="none";
  }
  function tellJoke(){
    const msg=jokes[Math.floor(Math.random()*jokes.length)];
    showAssistant(msg);
    options.style.display="none";
  }
  function motivateMe(){
    const msg=motivators[Math.floor(Math.random()*motivators.length)];
    showAssistant(msg);
    options.style.display="none";
  }
</script>
</body>
</html>
