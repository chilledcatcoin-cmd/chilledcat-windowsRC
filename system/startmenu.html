<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<style>
  body {
    margin: 0;
    font-family: "MS Sans Serif", sans-serif;
    font-size: 14px;
    background: #c0c0c0;
    display: flex;
  }
  .sidebar {
    width: 40px;
    background: #000080;
    color: white;
    writing-mode: vertical-rl;
    text-orientation: mixed;
    text-align: center;
    padding: 10px 0;
    font-weight: bold;
    transform: rotate(180deg);
  }
  .menu {
    flex: 1;
    display: flex;
    flex-direction: column;
    position: relative;
  }
  .item {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px 8px;
    cursor: default;
    white-space: nowrap;
    position: relative;
  }
  .item img {
    width: 16px;
    height: 16px;
    image-rendering: pixelated;
  }
  .item:hover {
    background: #000080;
    color: white;
  }
  .divider {
    border-top: 1px solid #808080;
    margin: 4px 0;
  }
</style>
</head>
<body>
  <div class="sidebar">Windows RC</div>
  <div class="menu">
    <!-- Programs now opens its own window instead of submenu -->
    <div class="item" onclick="openPrograms()">
      <img src="../media/icons/folder.png"> Programs
    </div>

    <div class="divider"></div>

    <div class="item" onclick="openPopup('find')">
      <img src="../media/icons/find.png"> Find
    </div>
    <div class="item" onclick="openPopup('settings')">
      <img src="../media/icons/settings.png"> Settings
    </div>
    <div class="item" onclick="openPopup('help')">
      <img src="../media/icons/help.png"> Help
    </div>
    <div class="item" onclick="openPopup('run')">
      <img src="../media/icons/run.png"> Run...
    </div>

    <div class="divider"></div>

    <div class="item" onclick="shutdown()">
      <img src="../media/icons/power.png"> Shut Down...
    </div>
  </div>

<script>
  function sendHeight() {
    window.top.postMessage({ type: 'resize-startmenu', height: document.body.scrollHeight }, '*');
  }
  window.onload = sendHeight;

function openPrograms() {
  // âœ… Close Start Menu immediately
  window.top.postMessage({ type: 'closeStartMenu' }, '*');

  // Then open the Programs window with custom size
  window.top.postMessage({
    type: 'openApp',
    app: './system/programs.html',
    id: 'programs',
    width: 600,
    height: 450
  }, '*');
}


  // Existing popup dialogs
  function openPopup(id) {
    window.top.postMessage({ type:'open-popup', id:id }, '*');
  }

  function shutdown() {
    window.top.postMessage('open-shutdown-dialog', '*');
  }
</script>
</body>
</html>
